/ k 2016.08.09
f:{(c+y+s),(1+s:x 1),,@[p;i;|p i:(#p:x 2)!(c:*x)+!y]}
h:{,/((2!+)/(8#2)\')'16 16#*|64{y f/x}[(`i$x),17 31 73 47 23]/0 0,,!256}
+/+/g:h'"jzgqcdpd-",/:$!128
n:k!{a@&1=g ./:a:(I,-I:=2)+\:x}'k:,/(!128),/:\:!128 / neighbors, precalc saves lots of time
-1+#?{$[g . x;{a@<a:?x,,/n x}/,x;!0]}'k
\\
