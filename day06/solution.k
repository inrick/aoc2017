/ k 2016.08.09
s:()
{~x in -1_s}{*|s,:,@[@[x;i;0];(#x)!1+(i:x?m)+!m:|/x;+;1]}\t:.:*0:`input;
n,(n:#s)-1+s?*|s
\\
