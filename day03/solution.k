/ k 2016.08.09
i:289326
w:+\(1 0;0 1;-1 0;0 -1) 4!&1+&(1+_%i)#2
{+/x|-x} w i-2  / zero indexed and origin missing
n:(,/(1-!3),/:\:1-!3)+\:
d:(,0 0)!,1
e:{i>d w x-1}{d[w x]:+/d n w x;x+1}/0
d w e-1
\\
